/*!
 * Torro Forms - Wheel of fortune Version 1.0.0 (http://torro-forms.com)
 * Licensed under GNU General Public License v3 (http://www.gnu.org/licenses/gpl-3.0.html)
 */
function Winwheel(t,e){defaultOptions={canvasId:"canvas",centerX:null,centerY:null,outerRadius:null,innerRadius:0,numSegments:1,drawMode:"code",rotationAngle:0,textFontFamily:"Arial",textFontSize:20,textFontWeight:"bold",textOrientation:"horizontal",textAlignment:"center",textDirection:"normal",textMargin:null,textFillStyle:"black",textStrokeStyle:null,textLineWidth:1,fillStyle:"silver",strokeStyle:"black",lineWidth:1,clearTheCanvas:!0,imageOverlay:!1,drawText:!0,pointerAngle:0,wheelImage:null};for(var i in defaultOptions)null!=t&&"undefined"!=typeof t[i]?this[i]=t[i]:this[i]=defaultOptions[i];if(null!=t)for(var i in t)"undefined"==typeof this[i]&&(this[i]=t[i]);for(this.canvasId?(this.canvas=document.getElementById(this.canvasId),this.canvas?(null==this.centerX&&(this.centerX=this.canvas.width/2),null==this.centerY&&(this.centerY=this.canvas.height/2),null==this.outerRadius&&(this.canvas.width<this.canvas.height?this.outerRadius=this.canvas.width/2-this.lineWidth:this.outerRadius=this.canvas.height/2-this.lineWidth),this.ctx=this.canvas.getContext("2d")):(this.canvas=null,this.ctx=null)):(this.cavnas=null,this.ctx=null),this.segments=new Array(null),x=1;x<=this.numSegments;x++)null!=t&&t.segments&&"undefined"!=typeof t.segments[x-1]?this.segments[x]=new Segment(t.segments[x-1]):this.segments[x]=new Segment;this.updateSegmentSizes(),null===this.textMargin&&(this.textMargin=this.textFontSize/1.7),null!=t&&t.animation&&"undefined"!=typeof t.animation?this.animation=new Animation(t.animation):this.animation=new Animation,"image"==this.drawMode?("undefined"==typeof t.fillStyle&&(this.fillStyle=null),"undefined"==typeof t.strokeStyle&&(this.strokeStyle="red"),"undefined"==typeof t.drawText&&(this.drawText=!1),"undefined"==typeof t.lineWidth&&(this.lineWidth=1),"undefined"==typeof e&&(e=!1)):"undefined"==typeof e&&(e=!0),null!=t&&t.pointerGuide&&"undefined"!=typeof t.pointerGuide?this.pointerGuide=new PointerGuide(t.pointerGuide):this.pointerGuide=new PointerGuide,1==e&&this.draw(this.clearTheCanvas)}function Animation(t){defaultOptions={type:"spinOngoing",direction:"clockwise",propertyName:null,propertyValue:null,duration:10,yoyo:!1,repeat:0,easing:"power3.easeOut",stopAngle:null,spins:null,clearTheCanvas:null,callbackFinished:null,callbackBefore:null,callbackAfter:null};for(var e in defaultOptions)null!=t&&"undefined"!=typeof t[e]?this[e]=t[e]:this[e]=defaultOptions[e];if(null!=t)for(var e in t)"undefined"==typeof this[e]&&(this[e]=t[e])}function Segment(t){defaultOptions={size:null,text:"",fillStyle:null,strokeStyle:null,lineWidth:null,textFontFamily:null,textFontSize:null,textFontWeight:null,textOrientation:null,textAlignment:null,textDirection:null,textMargin:null,textFillStyle:null,textStrokeStyle:null,textLineWidth:null};for(var e in defaultOptions)null!=t&&"undefined"!=typeof t[e]?this[e]=t[e]:this[e]=defaultOptions[e];if(null!=t)for(var e in t)"undefined"==typeof this[e]&&(this[e]=t[e]);this.startAngle=0,this.endAngle=0}function PointerGuide(t){defaultOptions={display:!1,strokeStyle:"red",lineWidth:3};for(var e in defaultOptions)null!=t&&"undefined"!=typeof t[e]?this[e]=t[e]:this[e]=defaultOptions[e]}function winwheelPercentToDegrees(t){var e=0;if(t>0&&t<=100){var i=t/100;e=360*i}return e}function winwheelAnimationLoop(){winwheelToDrawDuringAnimation&&(0!=winwheelToDrawDuringAnimation.animation.clearTheCanvas&&winwheelToDrawDuringAnimation.ctx.clearRect(0,0,winwheelToDrawDuringAnimation.canvas.width,winwheelToDrawDuringAnimation.canvas.height),null!=winwheelToDrawDuringAnimation.animation.callbackBefore&&eval(winwheelToDrawDuringAnimation.animation.callbackBefore),winwheelToDrawDuringAnimation.draw(!1),null!=winwheelToDrawDuringAnimation.animation.callbackAfter&&eval(winwheelToDrawDuringAnimation.animation.callbackAfter))}function winwheelStopAnimation(canCallback){TweenMax.ticker.removeEventListener("tick",winwheelAnimationLoop),0!=canCallback&&null!=winwheelToDrawDuringAnimation.animation.callbackFinished&&eval(winwheelToDrawDuringAnimation.animation.callbackFinished)}Winwheel.prototype.updateSegmentSizes=function(){if(this.segments){var t=0,e=0;for(x=1;x<=this.numSegments;x++)null!==this.segments[x].size&&(t+=this.segments[x].size,e++);var i=360-t,n=0;i>0&&(n=i/(this.numSegments-e));var s=0;for(x=1;x<=this.numSegments;x++)this.segments[x].startAngle=s,s+=this.segments[x].size?this.segments[x].size:n,this.segments[x].endAngle=s}},Winwheel.prototype.clearCanvas=function(){this.ctx&&this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},Winwheel.prototype.draw=function(t){this.ctx&&("undefined"!=typeof t?1==t&&this.clearCanvas():this.clearCanvas(),"image"==this.drawMode?(this.drawWheelImage(),1==this.drawText&&this.drawSegmentText(),1==this.imageOverlay&&this.drawSegments()):(this.drawSegments(),1==this.drawText&&this.drawSegmentText()),1==this.pointerGuide.display&&this.drawPointerGuide())},Winwheel.prototype.drawPointerGuide=function(){this.ctx&&(this.ctx.save(),this.ctx.translate(this.canvas.width/2,this.canvas.height/2),this.ctx.rotate(this.degToRad(this.pointerAngle)),this.ctx.translate(-this.canvas.width/2,-this.canvas.height/2),this.ctx.strokeStyle=this.pointerGuide.strokeStyle,this.ctx.lineWidth=this.pointerGuide.lineWidth,this.ctx.beginPath(),this.ctx.moveTo(this.canvas.width/2,this.canvas.height/2),this.ctx.lineTo(this.centerX,-(this.outerRadius/5)),this.ctx.stroke(),this.ctx.restore())},Winwheel.prototype.drawWheelImage=function(){if(null!=this.wheelImage){var t=this.centerX-this.wheelImage.height/2,e=this.centerY-this.wheelImage.width/2;this.ctx.save(),this.ctx.translate(this.canvas.width/2,this.canvas.height/2),this.ctx.rotate(this.degToRad(this.rotationAngle)),this.ctx.translate(-this.canvas.width/2,-this.canvas.height/2),this.ctx.drawImage(this.wheelImage,t,e),this.ctx.restore()}},Winwheel.prototype.drawSegments=function(){if(this.ctx&&this.segments)for(x=1;x<=this.numSegments;x++){seg=this.segments[x];var t,e,i;t=null!==seg.fillStyle?seg.fillStyle:this.fillStyle,this.ctx.fillStyle=t,e=null!==seg.lineWidth?seg.lineWidth:this.lineWidth,this.ctx.lineWidth=e,i=null!==seg.strokeStyle?seg.strokeStyle:this.strokeStyle,this.ctx.strokeStyle=i,(i||t)&&(this.ctx.beginPath(),this.innerRadius||this.ctx.moveTo(this.centerX,this.centerY),this.ctx.arc(this.centerX,this.centerY,this.outerRadius,this.degToRad(seg.startAngle+this.rotationAngle-90),this.degToRad(seg.endAngle+this.rotationAngle-90),!1),this.innerRadius?this.ctx.arc(this.centerX,this.centerY,this.innerRadius,this.degToRad(seg.endAngle+this.rotationAngle-90),this.degToRad(seg.startAngle+this.rotationAngle-90),!0):this.ctx.lineTo(this.centerX,this.centerY),t&&this.ctx.fill(),i&&this.ctx.stroke())}},Winwheel.prototype.drawSegmentText=function(){if(this.ctx){var t,e,i,n,s,a,h,r,o,l,c;for(x=1;x<=this.numSegments;x++){if(this.ctx.save(),seg=this.segments[x],seg.text)if(t=null!==seg.textFontFamily?seg.textFontFamily:this.textFontFamily,e=null!==seg.textFontSize?seg.textFontSize:this.textFontSize,i=null!==seg.textFontWeight?seg.textFontWeight:this.textFontWeight,n=null!==seg.textOrientation?seg.textOrientation:this.textOrientation,s=null!==seg.textAlignment?seg.textAlignment:this.textAlignment,a=null!==seg.textDirection?seg.textDirection:this.textDirection,h=null!==seg.textMargin?seg.textMargin:this.textMargin,r=null!==seg.textFillStyle?seg.textFillStyle:this.textFillStyle,o=null!==seg.textStrokeStyle?seg.textStrokeStyle:this.textStrokeStyle,l=null!==seg.textLineWidth?seg.textLineWidth:this.textLineWidth,c="",null!=i&&(c+=i+" "),null!=e&&(c+=e+"px "),null!=t&&(c+=t),this.ctx.font=c,this.ctx.fillStyle=r,this.ctx.strokeStyle=o,this.ctx.lineWidth=l,"reversed"==a){if("horizontal"==n){"inner"==s?this.ctx.textAlign="right":"outer"==s?this.ctx.textAlign="left":this.ctx.textAlign="center",this.ctx.textBaseline="middle";var g=this.degToRad(seg.endAngle-(seg.endAngle-seg.startAngle)/2+this.rotationAngle-90-180);this.ctx.save(),this.ctx.translate(this.canvas.width/2,this.canvas.height/2),this.ctx.rotate(g),this.ctx.translate(-this.canvas.width/2,-this.canvas.height/2),"inner"==s?(r&&this.ctx.fillText(seg.text,this.centerX-this.innerRadius-h,this.centerY),o&&this.ctx.strokeText(seg.text,this.centerX-this.innerRadius-h,this.centerY)):"outer"==s?(r&&this.ctx.fillText(seg.text,this.centerX-this.outerRadius+h,this.centerY),o&&this.ctx.strokeText(seg.text,this.centerX-this.outerRadius+h,this.centerY)):(r&&this.ctx.fillText(seg.text,this.centerX-this.innerRadius-(this.outerRadius-this.innerRadius)/2-h,this.centerY),o&&this.ctx.strokeText(seg.text,this.centerX-this.innerRadius-(this.outerRadius-this.innerRadius)/2-h,this.centerY)),this.ctx.restore()}else if("vertical"==n){this.ctx.textAlign="center","inner"==s?this.ctx.textBaseline="top":"outer"==s?this.ctx.textBaseline="bottom":this.ctx.textBaseline="middle";var g=seg.endAngle-(seg.endAngle-seg.startAngle)/2-180;if(g+=this.rotationAngle,this.ctx.save(),this.ctx.translate(this.centerX,this.centerY),this.ctx.rotate(this.degToRad(g)),this.ctx.translate(-this.centerX,-this.centerY),"outer"==s)var u=this.centerY+this.outerRadius-h;else if("inner"==s)var u=this.centerY+this.innerRadius+h;var d=e-e/9;if("outer"==s)for(var m=seg.text.length-1;m>=0;m--)character=seg.text.charAt(m),r&&this.ctx.fillText(character,this.centerX,u),o&&this.ctx.strokeText(character,this.centerX,u),u-=d;else if("inner"==s)for(var m=0;m<seg.text.length;m++)character=seg.text.charAt(m),r&&this.ctx.fillText(character,this.centerX,u),o&&this.ctx.strokeText(character,this.centerX,u),u+=d;else if("center"==s){var p=0;seg.text.length>1&&(p=d*(seg.text.length-1)/2);for(var u=this.centerY+this.innerRadius+(this.outerRadius-this.innerRadius)/2+p+h,m=seg.text.length-1;m>=0;m--)character=seg.text.charAt(m),r&&this.ctx.fillText(character,this.centerX,u),o&&this.ctx.strokeText(character,this.centerX,u),u-=d}this.ctx.restore()}else if("curved"==n){var f=0;"inner"==s?(f=this.innerRadius+h,this.ctx.textBaseline="top"):"outer"==s?(f=this.outerRadius-h,this.ctx.textBaseline="bottom"):"center"==s&&(f=this.innerRadius+h+(this.outerRadius-this.innerRadius)/2,this.ctx.textBaseline="middle");var w=0,A=0;for(seg.text.length>1?(this.ctx.textAlign="left",w=4*(e/10),radiusPercent=100/f,w*=radiusPercent,totalArc=w*seg.text.length,A=seg.startAngle+((seg.endAngle-seg.startAngle)/2-totalArc/2)):(A=seg.startAngle+(seg.endAngle-seg.startAngle)/2,this.ctx.textAlign="center"),A+=this.rotationAngle,A-=180,m=seg.text.length;m>=0;m--)this.ctx.save(),character=seg.text.charAt(m),this.ctx.translate(this.centerX,this.centerY),this.ctx.rotate(this.degToRad(A)),this.ctx.translate(-this.centerX,-this.centerY),o&&this.ctx.strokeText(character,this.centerX,this.centerY+f),r&&this.ctx.fillText(character,this.centerX,this.centerY+f),A+=w,this.ctx.restore()}}else if("horizontal"==n){"inner"==s?this.ctx.textAlign="left":"outer"==s?this.ctx.textAlign="right":this.ctx.textAlign="center",this.ctx.textBaseline="middle";var g=this.degToRad(seg.endAngle-(seg.endAngle-seg.startAngle)/2+this.rotationAngle-90);this.ctx.save(),this.ctx.translate(this.centerX,this.centerY),this.ctx.rotate(g),this.ctx.translate(-this.centerX,-this.centerY),"inner"==s?(r&&this.ctx.fillText(seg.text,this.centerX+this.innerRadius+h,this.centerY),o&&this.ctx.strokeText(seg.text,this.centerX+this.innerRadius+h,this.centerY)):"outer"==s?(r&&this.ctx.fillText(seg.text,this.centerX+this.outerRadius-h,this.centerY),o&&this.ctx.strokeText(seg.text,this.centerX+this.outerRadius-h,this.centerY)):(r&&this.ctx.fillText(seg.text,this.centerX+this.innerRadius+(this.outerRadius-this.innerRadius)/2+h,this.centerY),o&&this.ctx.strokeText(seg.text,this.centerX+this.innerRadius+(this.outerRadius-this.innerRadius)/2+h,this.centerY)),this.ctx.restore()}else if("vertical"==n){this.ctx.textAlign="center","inner"==s?this.ctx.textBaseline="bottom":"outer"==s?this.ctx.textBaseline="top":this.ctx.textBaseline="middle";var g=seg.endAngle-(seg.endAngle-seg.startAngle)/2;if(g+=this.rotationAngle,this.ctx.save(),this.ctx.translate(this.centerX,this.centerY),this.ctx.rotate(this.degToRad(g)),this.ctx.translate(-this.centerX,-this.centerY),"outer"==s)var u=this.centerY-this.outerRadius+h;else if("inner"==s)var u=this.centerY-this.innerRadius-h;var d=e-e/9;if("outer"==s)for(var m=0;m<seg.text.length;m++)character=seg.text.charAt(m),r&&this.ctx.fillText(character,this.centerX,u),o&&this.ctx.strokeText(character,this.centerX,u),u+=d;else if("inner"==s)for(var m=seg.text.length-1;m>=0;m--)character=seg.text.charAt(m),r&&this.ctx.fillText(character,this.centerX,u),o&&this.ctx.strokeText(character,this.centerX,u),u-=d;else if("center"==s){var p=0;seg.text.length>1&&(p=d*(seg.text.length-1)/2);for(var u=this.centerY-this.innerRadius-(this.outerRadius-this.innerRadius)/2-p-h,m=0;m<seg.text.length;m++)character=seg.text.charAt(m),r&&this.ctx.fillText(character,this.centerX,u),o&&this.ctx.strokeText(character,this.centerX,u),u+=d}this.ctx.restore()}else if("curved"==n){var f=0;"inner"==s?(f=this.innerRadius+h,this.ctx.textBaseline="bottom"):"outer"==s?(f=this.outerRadius-h,this.ctx.textBaseline="top"):"center"==s&&(f=this.innerRadius+h+(this.outerRadius-this.innerRadius)/2,this.ctx.textBaseline="middle");var w=0,A=0;for(seg.text.length>1?(this.ctx.textAlign="left",w=4*(e/10),radiusPercent=100/f,w*=radiusPercent,totalArc=w*seg.text.length,A=seg.startAngle+((seg.endAngle-seg.startAngle)/2-totalArc/2)):(A=seg.startAngle+(seg.endAngle-seg.startAngle)/2,this.ctx.textAlign="center"),A+=this.rotationAngle,m=0;m<seg.text.length;m++)this.ctx.save(),character=seg.text.charAt(m),this.ctx.translate(this.centerX,this.centerY),this.ctx.rotate(this.degToRad(A)),this.ctx.translate(-this.centerX,-this.centerY),o&&this.ctx.strokeText(character,this.centerX,this.centerY-f),r&&this.ctx.fillText(character,this.centerX,this.centerY-f),A+=w,this.ctx.restore()}this.ctx.restore()}}},Winwheel.prototype.degToRad=function(t){return.017453292519943295*t},Winwheel.prototype.setCenter=function(t,e){this.centerX=t,this.centerY=e},Winwheel.prototype.addSegment=function(t,e){newSegment=new Segment(t),this.numSegments++;var i;if("undefined"!=typeof e){for(var n=this.numSegments;n>e;n--)this.segments[n]=this.segments[n-1];this.segments[e]=newSegment,i=e}else this.segments[this.numSegments]=newSegment,i=this.numSegments;return this.updateSegmentSizes(),this.segments[i]},Winwheel.prototype.setCanvasId=function(t){t?(this.canvasId=t,this.canvas=document.getElementById(this.canvasId),this.canvas&&(this.ctx=this.canvas.getContext("2d"))):(this.canvasId=null,this.ctx=null,this.canvas=null)},Winwheel.prototype.deleteSegment=function(t){if(this.numSegments>1){if("undefined"!=typeof t)for(var e=t;e<this.numSegments;e++)this.segments[e]=this.segments[e+1];this.segments[this.numSegments]=void 0,this.numSegments--,this.updateSegmentSizes()}},Winwheel.prototype.windowToCanvas=function(t,e){var i=this.canvas.getBoundingClientRect();return{x:Math.floor(t-i.left*(this.canvas.width/i.width)),y:Math.floor(e-i.top*(this.canvas.height/i.height))}},Winwheel.prototype.getSegmentAt=function(t,e){var i=null,n=this.getSegmentNumberAt(t,e);return null!==n&&(i=this.segments[n]),i},Winwheel.prototype.getSegmentNumberAt=function(t,e){var i,n,s,a,h,r=this.windowToCanvas(t,e);r.x>this.centerX?(s=r.x-this.centerX,n="R"):(s=this.centerX-r.x,n="L"),r.y>this.centerY?(a=r.y-this.centerY,i="B"):(a=this.centerY-r.y,i="T");var o=a/s,l=180*Math.atan(o)/Math.PI,c=0;if(h=Math.sqrt(a*a+s*s),"T"==i&&"R"==n?c=Math.round(90-l):"B"==i&&"R"==n?c=Math.round(l+90):"B"==i&&"L"==n?c=Math.round(90-l+180):"T"==i&&"L"==n&&(c=Math.round(l+270)),0!=this.rotationAngle){var g=this.getRotationPosition();c-=g,c<0&&(c=360-Math.abs(c))}for(var u=null,t=1;t<=this.numSegments;t++)if(c>=this.segments[t].startAngle&&c<=this.segments[t].endAngle&&h>=this.innerRadius&&h<=this.outerRadius){u=t;break}return u},Winwheel.prototype.getIndicatedSegment=function(){var t=this.getIndicatedSegmentNumber();return this.segments[t]},Winwheel.prototype.getIndicatedSegmentNumber=function(){var t=0,e=this.getRotationPosition(),i=Math.floor(this.pointerAngle-e);for(i<0&&(i=360-Math.abs(i)),x=1;x<this.segments.length;x++)if(i>=this.segments[x].startAngle&&i<=this.segments[x].endAngle){t=x;break}return t},Winwheel.prototype.getRotationPosition=function(){var t=this.rotationAngle;if(t>=0){if(t>360){var e=Math.floor(t/360);t-=360*e}}else{if(t<-360){var e=Math.ceil(t/360);t-=360*e}t=360+t}return t},Winwheel.prototype.startAnimation=function(){if(this.animation){this.computeAnimation(),winwheelToDrawDuringAnimation=this,TweenMax.ticker.addEventListener("tick",winwheelAnimationLoop);var t=new Array(null);t[this.animation.propertyName]=this.animation.propertyValue,t.yoyo=this.animation.yoyo,t.repeat=this.animation.repeat,t.ease=this.animation.easing,t.onComplete=winwheelStopAnimation,this.tween=TweenMax.to(this,this.animation.duration,t)}},Winwheel.prototype.stopAnimation=function(t){winwheelToDrawDuringAnimation.tween.kill(),winwheelToDrawDuringAnimation=this,winwheelStopAnimation(t)},Winwheel.prototype.pauseAnimation=function(){this.tween&&this.tween.pause()},Winwheel.prototype.resumeAnimation=function(){this.tween&&this.tween.play()},Winwheel.prototype.computeAnimation=function(){this.animation&&("spinOngoing"==this.animation.type?(this.animation.propertyName="rotationAngle",null==this.animation.spins&&(this.animation.spins=5),null==this.animation.repeat&&(this.animation.repeat=-1),null==this.animation.easing&&(this.animation.easing="Linear.easeNone"),null==this.animation.yoyo&&(this.animation.yoyo=!1),this.animation.propertyValue=360*this.animation.spins,"anti-clockwise"==this.animation.direction&&(this.animation.propertyValue=0-this.animation.propertyValue)):"spinToStop"==this.animation.type?(this.animation.propertyName="rotationAngle",null==this.animation.spins&&(this.animation.spins=5),null==this.animation.repeat&&(this.animation.repeat=0),null==this.animation.easing&&(this.animation.easing="Power4.easeOut"),null==this.animation.stopAngle?this.animation._stopAngle=Math.floor(359*Math.random()):this.animation._stopAngle=360-this.animation.stopAngle,null==this.animation.yoyo&&(this.animation.yoyo=!1),this.animation.propertyValue=360*this.animation.spins,"anti-clockwise"==this.animation.direction?(this.animation.propertyValue=0-this.animation.propertyValue,this.animation.propertyValue-=360-this.animation._stopAngle):this.animation.propertyValue+=this.animation._stopAngle):"spinAndBack"==this.animation.type?(this.animation.propertyName="rotationAngle",null==this.animation.spins&&(this.animation.spins=5),null==this.animation.repeat&&(this.animation.repeat=1),null==this.animation.easing&&(this.animation.easing="Power2.easeInOut"),null==this.animation.yoyo&&(this.animation.yoyo=!0),null==this.animation.stopAngle?this.animation._stopAngle=0:this.animation._stopAngle=360-this.animation.stopAngle,this.animation.propertyValue=360*this.animation.spins,"anti-clockwise"==this.animation.direction?(this.animation.propertyValue=0-this.animation.propertyValue,this.animation.propertyValue-=360-this.animation._stopAngle):this.animation.propertyValue+=this.animation._stopAngle):"custom"==this.animation.type)},Winwheel.prototype.getRandomForSegment=function(t){var e=0;if(t&&"undefined"!=typeof this.segments[t]){var i=this.segments[t].startAngle,n=this.segments[t].endAngle,s=n-i-2;s>0&&(e=i+1+Math.floor(Math.random()*s))}return e};var winwheelToDrawDuringAnimation=null;